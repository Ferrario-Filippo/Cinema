@model Cinema.Models.ViewModels.BuyTicketsViewModel
@{
	ViewData["Title"] = "Compra";
}

<div class="row g-4 mb-5">
	<input hidden asp-for="ShowId" id="showIdInput" />
	<div class="col-lg-4">
		<h4 class="d-flex flex-column justify-content-between align-items-center mb-3">
			<span class="text-primary">@Model.FilmTitle</span>
			<span>@Model.Date.ToString("hh:mm dd/MM/yyyy")</span>
		</h4>
		<ul class="list-group mb-3">
			<li class="list-group-item d-flex justify-content-between lh-sm">
				<div>
					<h6 class="my-0">Product name</h6>
					<small class="text-body-secondary">Brief description</small>
				</div>
				<span class="text-body-secondary">$12</span>
			</li>
			<li class="list-group-item d-flex justify-content-between lh-sm">
				<div>
					<h6 class="my-0">Second product</h6>
					<small class="text-body-secondary">Brief description</small>
				</div>
				<span class="text-body-secondary">$8</span>
			</li>
			<li class="list-group-item d-flex justify-content-between lh-sm">
				<div>
					<h6 class="my-0">Third item</h6>
					<small class="text-body-secondary">Brief description</small>
				</div>
				<span class="text-body-secondary">$5</span>
			</li>
			<li class="list-group-item d-flex justify-content-between">
				<span>Totale (EUR)</span>
				<strong id="totalCost">0,00</strong>
			</li>
		</ul>
	</div>
	<div class="col-lg-8">
		<form method="post" asp-action="Buy">
			<h3>Scegli i biglietti</h3>
			<div>
				<div class="seats-section flex-column justify-content-center mb-5 mt-3">
					@for (int i = 0, lane = 0; i < Model.Capacity; lane++)
					{
						var seatsPerLane = Cinema.Helpers.TicketHelpers.GetMaxSeatsPerLane(lane);
						<div class="d-flex flex-row mx-auto">
							@for (int j = 0; j < seatsPerLane && i < Model.Capacity; j++, i++)
							{
								<button type="button" disabled class="seat" id="@((char)(65 + lane))~@(j + 1)" onclick="onSeatClicked()">
									<img src="~/images/site/seat.png" class="seat-img unavailable-seat" />
								</button>
							}
						</div>
					}
				</div>
				<div class="col-md-0">
				</div>
			</div>

			<h4 class="mb-3">Pagamento</h4>

			<div class="row my-3 col-sm-6 ">
				<label asp-for="ChosenPayment"></label>
				<select asp-for="ChosenPayment" id="paymentSelect" class="form-select" asp-items="@Model.PaymentMethods" onchange="onPaymentChanged()">
					<option disabled selected>--Seleziona il metodo di pagamento--</option>
				</select>
				<span asp-validation-for="ChosenPayment" class="text-danger"></span>
			</div>

			<div class="row gy-3" id="ccInfo">
				<div class="col-md-6">
					<label asp-for="NameOnCard" class="form-label"></label>
					<input type="text" class="form-control payment" asp-for="NameOnCard" maxlength="32">
					<span asp-validation-for="NameOnCard" class="text-danger"></span>
				</div>

				<div class="col-md-6">
					<label asp-for="CardNumber" class="form-label"></label>
					<input type="text" class="form-control payment" asp-for="CardNumber" maxlength="12">
					<span asp-validation-for="CardNumber" class="text-danger"></span>
				</div>

				<div class="col-md-3">
					<label asp-for="Expire" class="form-label"></label>
					<input type="text" class="form-control payment" asp-for="Expire" maxlength="5">
					<span asp-validation-for="Expire" class="text-danger"></span>
				</div>

				<div class="col-md-3">
					<label asp-for="CCV" class="form-label"></label>
					<input type="text" class="form-control payment" asp-for="CCV" maxlength="3">
					<span asp-validation-for="CCV" class="text-danger"></span>
				</div>
			</div>

			<hr class="my-4">

			<button class="w-100 btn btn-primary btn-lg" type="submit">Conferma acquisto</button>
		</form>
	</div>
</div>
<section Scripts>
	<script src="~/js/buy.js"></script>
</section>
